<!doctype html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Audio Autoplay</title>
<style>
  :root { font-family: system-ui; }
  body { margin:0; min-height:100dvh; display:grid; place-items:center; }
  main { width:min(680px, 92vw); text-align:center; }
  ul { list-style:none; padding:0; margin:1rem 0 0; }
  li { margin:.4rem 0; }
  a, button { font-size:1.05rem; text-decoration:none; padding:.6rem 1rem; border:1px solid #ccc; border-radius:.6rem; display:inline-block; }
  a:hover, button:hover { background:#f5f5f5; }
</style>

<main id="app">
  <noscript>Bitte JavaScript aktivieren.</noscript>
</main>

<script>
  // Liste deiner Dateien. Namen und Endungen genau wie im Repo.
  const files = [
    { name: "FÃ¼hlbild aus NÃ¤geln", file: "FÃ¼hlbild aus NÃ¤geln.m4a" },
    { name: "Tischbau",            file: "Tischbau.m4a" },
    { name: "HÃ¶rmemory",           file: "HÃ¶rmemory.m4a" },
    { name: "Balancierweg",        file: "Balancierweg.m4a" },
    { name: "BarfuÃŸweg",           file: "BarfuÃŸweg.m4a" },
    { name: "FÃ¼hlkiste",           file: "FÃ¼hlkiste.m4a" }
  ];

  const app = document.getElementById("app");
  const params = new URLSearchParams(location.search);
  const queryFile = params.get("f");    // z. B. ?f=FÃ¼hlkiste.m4a

  function renderList() {
    const h = document.createElement("h1");
    h.textContent = "Audios";
    const p = document.createElement("p");
    p.textContent = "Klicke auf einen Titel. Der Link Ã¶ffnet diese Seite mit Autoplay-Versuch.";
    const ul = document.createElement("ul");

    for (const {name, file} of files) {
      const li = document.createElement("li");
      const a = document.createElement("a");
      a.href = `?f=${encodeURIComponent(file)}`;
      a.textContent = `â–¶ ${name}`;
      li.appendChild(a);
      ul.appendChild(li);
    }
    app.replaceChildren(h, p, ul);
  }

  async function playFile(filename) {
    const audio = document.createElement("audio");
    audio.id = "player";
    audio.preload = "auto";
    audio.src = filename; // Browser kÃ¼mmert sich um Encoding
    const label = document.createElement("p");
    label.textContent = `Lade: ${filename}`;
    app.replaceChildren(label);

    try {
      await audio.play();            // Autoplay-Versuch
      app.textContent = `ðŸŽ§ Wiedergabe lÃ¤uft: ${filename}`;
    } catch {
      const btn = document.createElement("button");
      btn.textContent = "â–¶ï¸ Abspielen";
      btn.onclick = () => audio.play().then(() => btn.replaceWith("ðŸŽ§ Wiedergabe lÃ¤uft"));
      app.replaceChildren(btn);
    }
    document.body.appendChild(audio);
  }

  if (queryFile) playFile(decodeURIComponent(queryFile));
  else renderList();
</script>
